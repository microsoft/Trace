
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Single Agent: Battleship &#8212; Trace</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=987ea60b" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/game/joint_code_optimization';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Multi-Agent: Negotiation Arena" href="joint_prompt_optimization.html" />
    <link rel="prev" title="Error Handling" href="../../tutorials/error_handling_tutorial.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Trace</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    üéØ Trace
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">üí°Quick Start</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/installation.html">üåê  Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/quick_start.html">‚ö°Ô∏è 5 Minutes Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/quick_start_2.html">üöÄ Next 5 Minutes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/quick_start_3.html">ü§Ø Last 5 Minutes</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">üìöTutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/basic_tutorial.html">Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/optimization_tutorial.html">Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/error_handling_tutorial.html">Error Handling</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Agent Examples</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Single Agent: Battleship</a></li>


<li class="toctree-l1"><a class="reference internal" href="joint_prompt_optimization.html">Multi-Agent: Negotiation Arena</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NLP Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../joint/joint_code_prompt_optimization.html">BigBench-Hard</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Robotics Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../code/metaworld.html">Meta-World</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">üìñ API Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/opto/opto.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/opto/opto.trace.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.trace</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/opto/opto.trace.propagators.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.trace.propagators</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/opto/opto.trace.propagators.propagators.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.trace.propagators.propagators</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/opto/opto.trace.propagators.graph_propagator.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.trace.propagators.graph_propagator</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/opto/opto.optimizers.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.optimizers</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/opto/opto.version.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.version</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api/opto/opto.optimizers.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.optimizers</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/opto/opto.optimizers.buffers.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.optimizers.buffers</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/opto/opto.optimizers.opro.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.optimizers.opro</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/opto/opto.optimizers.optimizer.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.optimizers.optimizer</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/opto/opto.optimizers.optoprime.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.optimizers.optoprime</span></code></a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/opto/opto.trace.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.trace</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/opto/opto.trace.propagators.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.trace.propagators</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/opto/opto.trace.propagators.propagators.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.trace.propagators.propagators</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/opto/opto.trace.propagators.graph_propagator.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.trace.propagators.graph_propagator</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api/opto/opto.trace.broadcast.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.trace.broadcast</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/opto/opto.trace.bundle.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.trace.bundle</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/opto/opto.trace.containers.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.trace.containers</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/opto/opto.trace.errors.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.trace.errors</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/opto/opto.trace.iterators.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.trace.iterators</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/opto/opto.trace.modules.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.trace.modules</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/opto/opto.trace.nodes.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.trace.nodes</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/opto/opto.trace.operators.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.trace.operators</span></code></a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/opto/opto.trace.propagators.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.trace.propagators</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/opto/opto.trace.propagators.propagators.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.trace.propagators.propagators</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/opto/opto.trace.propagators.graph_propagator.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.trace.propagators.graph_propagator</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api/opto/opto.trace.propagators.graph_propagator.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.trace.propagators.graph_propagator</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/opto/opto.trace.propagators.propagators.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.trace.propagators.propagators</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/opto/opto.trace.utils.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.trace.utils</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/opto/opto.version.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">opto.version</span></code></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/microsoft/Trace/blob/website/docs/examples/game/joint_code_optimization.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>



<a href="https://github.com/microsoft/Trace" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/examples/game/joint_code_optimization.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Single Agent: Battleship</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Single Agent: Battleship</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-and-installation">Setup and Installation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#environment-setup">Environment Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wrap-the-environment-into-a-battleshipboard-class">Wrap the environment into a BattleshipBoard class</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-a-policy-class-with-multiple-trainable-functions">Define a Policy class with multiple trainable functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-functions-to-rollout-and-evaluate-the-policy">Helper Functions to rollout and evaluate the policy</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-the-initial-policy">Creating the initial policy</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#putting-it-all-together">Putting it all together</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="single-agent-battleship">
<h1>Single Agent: Battleship<a class="headerlink" href="#single-agent-battleship" title="Link to this heading">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>This notebook will focus on using <code class="docutils literal notranslate"><span class="pre">trace</span></code> to optimize multiple pieces of code automatically in the context of a Battleship game.</p>
</section>
<section id="setup-and-installation">
<h2>Setup and Installation<a class="headerlink" href="#setup-and-installation" title="Link to this heading">#</a></h2>
<p>Let‚Äôs start by importing the necessary libraries.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">opto.trace</span> <span class="kn">import</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">Module</span><span class="p">,</span> <span class="n">GRAPH</span>
<span class="kn">from</span> <span class="nn">opto.trace.errors</span> <span class="kn">import</span> <span class="n">ExecutionError</span>
<span class="kn">from</span> <span class="nn">opto.trace.bundle</span> <span class="kn">import</span> <span class="n">ExceptionNode</span>
<span class="kn">from</span> <span class="nn">opto.optimizers</span> <span class="kn">import</span> <span class="n">OptoPrime</span>
<span class="kn">from</span> <span class="nn">autogen</span> <span class="kn">import</span> <span class="n">config_list_from_json</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="environment-setup">
<h2>Environment Setup<a class="headerlink" href="#environment-setup" title="Link to this heading">#</a></h2>
<p>Define the Battleship board creation and environment handling functions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_battleship_board</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
    <span class="n">board</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;.&#39;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">width</span><span class="p">)]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">height</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">board</span>

<span class="k">def</span> <span class="nf">can_place_ship</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_vertical</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">is_vertical</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">row</span> <span class="o">+</span> <span class="n">size</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">board</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="n">i</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;.&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">col</span> <span class="o">+</span> <span class="n">size</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;.&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>

<span class="k">def</span> <span class="nf">place_ship</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_vertical</span><span class="p">,</span> <span class="n">ship_symbol</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">is_vertical</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
            <span class="n">board</span><span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="n">i</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">ship_symbol</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
            <span class="n">board</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ship_symbol</span>

<span class="k">def</span> <span class="nf">create_and_fill_battleship_board</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">ships</span><span class="p">,</span> <span class="n">num_each_type</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">board</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;.&#39;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">width</span><span class="p">)]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">height</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">ship_symbol</span><span class="p">,</span> <span class="n">size</span> <span class="ow">in</span> <span class="n">ships</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_each_type</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">placed</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">while</span> <span class="ow">not</span> <span class="n">placed</span><span class="p">:</span>
                <span class="n">row</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">col</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">is_vertical</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">can_place_ship</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_vertical</span><span class="p">):</span>
                    <span class="n">place_ship</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_vertical</span><span class="p">,</span> <span class="n">ship_symbol</span><span class="p">)</span>
                    <span class="n">placed</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="n">board</span>

<span class="k">def</span> <span class="nf">check_hit</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">board</span><span class="p">)</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">col</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">]:</span>
            <span class="n">board</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;X&#39;</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;.&#39;</span><span class="p">:</span>
                <span class="n">board</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;O&#39;</span>
    <span class="k">return</span> <span class="kc">False</span>

<span class="c1"># Ships to be placed on the board</span>
<span class="n">ships</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>  <span class="c1"># Carrier</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>  <span class="c1"># Battleship</span>
    <span class="s1">&#39;R&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>  <span class="c1"># Cruiser</span>
    <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>  <span class="c1"># Submarine</span>
    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="mi">2</span>  <span class="c1"># Destroyer</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="wrap-the-environment-into-a-battleshipboard-class">
<h2>Wrap the environment into a BattleshipBoard class<a class="headerlink" href="#wrap-the-environment-into-a-battleshipboard-class" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define BattleshipBoard class</span>
<span class="k">class</span> <span class="nc">BattleshipBoard</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">num_each_type</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">exclude_ships</span><span class="o">=</span><span class="p">[],</span> <span class="n">init_with_one_hit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">height</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ships</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="p">:</span> <span class="n">ships</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">ships</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude_ships</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">board</span> <span class="o">=</span> <span class="n">create_and_fill_battleship_board</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ships</span><span class="p">,</span> <span class="n">num_each_type</span><span class="o">=</span><span class="n">num_each_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shots</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;.&#39;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">width</span><span class="p">)]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">height</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hits</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">misses</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="n">init_with_one_hit</span><span class="p">:</span>
            <span class="n">initialized</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">height</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">width</span><span class="p">):</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;.&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">check_shot</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
                        <span class="n">initialized</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">break</span>
                <span class="k">if</span> <span class="n">initialized</span><span class="p">:</span>
                    <span class="k">break</span>

    <span class="k">def</span> <span class="nf">get_life_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ships</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">check_shot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
        <span class="n">is_hit</span> <span class="o">=</span> <span class="n">check_hit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_hit</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hits</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shots</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;X&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">misses</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shots</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;.&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shots</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;O&#39;</span>
        <span class="k">return</span> <span class="n">is_hit</span>

    <span class="k">def</span> <span class="nf">check_terminate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hits</span> <span class="o">&gt;=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ships</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">misses</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">hits</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_board</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">board</span>

    <span class="k">def</span> <span class="nf">get_shots</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shots</span>

    <span class="k">def</span> <span class="nf">get_shots_overlay_board</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">shots_overlay_board</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shots</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;.&#39;</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">shots</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">)]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">shots_overlay_board</span>

    <span class="k">def</span> <span class="nf">get_hits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">hits</span>

    <span class="k">def</span> <span class="nf">get_misses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">misses</span>

    <span class="k">def</span> <span class="nf">get_game_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hits</span> <span class="o">==</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ships</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
            <span class="k">return</span> <span class="s1">&#39;Game Over: All ships sunk!&#39;</span>
        <span class="k">return</span> <span class="s1">&#39;Game in progress&#39;</span>

    <span class="k">def</span> <span class="nf">visualize_board</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_rep</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">:</span>
            <span class="n">str_rep</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">str_rep</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">visualize_own_board</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_rep</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">board</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_shots_overlay_board</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">board</span><span class="p">:</span>
            <span class="n">str_rep</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">str_rep</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">visualize_shots</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">str_rep</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">shots</span><span class="p">:</span>
            <span class="n">str_rep</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">str_rep</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-a-policy-class-with-multiple-trainable-functions">
<h2>Define a Policy class with multiple trainable functions<a class="headerlink" href="#define-a-policy-class-with-multiple-trainable-functions" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define Policy class</span>
<span class="k">class</span> <span class="nc">Policy</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">map</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_coordinate</span><span class="p">(</span><span class="nb">map</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>

    <span class="k">def</span> <span class="nf">select_coordinate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">map</span><span class="p">):</span>
        <span class="n">plan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reason</span><span class="p">(</span><span class="nb">map</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">act</span><span class="p">(</span><span class="nb">map</span><span class="p">,</span> <span class="n">plan</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="nd">@bundle</span><span class="p">(</span><span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">act</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">map</span><span class="p">,</span> <span class="n">plan</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given a map, select a target coordinate in a game.</span>
<span class="sd">        X denotes hits, O denotes misses, and . denotes unknown positions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span>

    <span class="nd">@bundle</span><span class="p">(</span><span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">reason</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">map</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given a map, analyze the board in a game.</span>
<span class="sd">        X denotes hits, O denotes misses, and . denotes unknown positions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="helper-functions-to-rollout-and-evaluate-the-policy">
<h2>Helper Functions to rollout and evaluate the policy<a class="headerlink" href="#helper-functions-to-rollout-and-evaluate-the-policy" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function to get user feedback for placing shot</span>
<span class="k">def</span> <span class="nf">user_fb_for_placing_shot</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">coords</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">reward</span> <span class="o">=</span> <span class="n">board</span><span class="o">.</span><span class="n">check_shot</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">new_map</span> <span class="o">=</span> <span class="n">board</span><span class="o">.</span><span class="n">get_shots</span><span class="p">()</span>
        <span class="n">terminal</span> <span class="o">=</span> <span class="n">board</span><span class="o">.</span><span class="n">check_terminate</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new_map</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">terminal</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">reward</span><span class="p">)</span><span class="si">}</span><span class="s2"> reward.&quot;</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">board</span><span class="o">.</span><span class="n">misses</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">board</span><span class="o">.</span><span class="n">get_shots</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    
<span class="c1"># Function to rollout policy</span>
<span class="k">def</span> <span class="nf">rollout</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">board</span><span class="p">):</span>
    <span class="n">rewards</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">board</span><span class="o">.</span><span class="n">get_shots</span><span class="p">()</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">board</span><span class="o">.</span><span class="n">check_terminate</span><span class="p">():</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">policy</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
        <span class="n">obs</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">terminal</span><span class="p">,</span> <span class="n">feedback</span> <span class="o">=</span> <span class="n">user_fb_for_placing_shot</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">terminal</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">rewards</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reward</span><span class="p">)</span>
    <span class="n">rewards</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rewards</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rewards</span>

<span class="c1"># Function to evaluate policy</span>
<span class="k">def</span> <span class="nf">eval_policy</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">board_size</span><span class="p">,</span> <span class="n">num_each_type</span><span class="p">,</span> <span class="n">exclude_ships</span><span class="p">,</span> <span class="n">n_eval_episodes</span><span class="p">):</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_eval_episodes</span><span class="p">):</span>
        <span class="n">board</span> <span class="o">=</span> <span class="n">BattleshipBoard</span><span class="p">(</span><span class="n">board_size</span><span class="p">,</span> <span class="n">board_size</span><span class="p">,</span> <span class="n">num_each_type</span><span class="o">=</span><span class="n">num_each_type</span><span class="p">,</span> <span class="n">exclude_ships</span><span class="o">=</span><span class="n">exclude_ships</span><span class="p">)</span>
        <span class="n">rewards</span> <span class="o">=</span> <span class="n">rollout</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">board</span><span class="p">)</span>
        <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rewards</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Scores: </span><span class="si">{</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">scores</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="creating-the-initial-policy">
<h1>Creating the initial policy<a class="headerlink" href="#creating-the-initial-policy" title="Link to this heading">#</a></h1>
<p>Finally, create a <code class="docutils literal notranslate"><span class="pre">Policy</span></code> object and evaluate the performance of the initial code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set parameters</span>
<span class="n">board_size</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">num_each_type</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">exclude_ships</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="n">n_eval_episodes</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># Create policy and evaluate</span>
<span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">()</span>
<span class="n">init_scores</span> <span class="o">=</span> <span class="n">eval_policy</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">board_size</span><span class="p">,</span> <span class="n">num_each_type</span><span class="p">,</span> <span class="n">exclude_ships</span><span class="p">,</span> <span class="n">n_eval_episodes</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Initial scores:&quot;</span><span class="p">,</span> <span class="n">init_scores</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Scores: 0.0 (0.0)
Initial scores: [0. 0. 0.]
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="putting-it-all-together">
<h1>Putting it all together<a class="headerlink" href="#putting-it-all-together" title="Link to this heading">#</a></h1>
<p>Create an optimizer and evaluate the online optimization of the produced codes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">OptoPrime</span><span class="p">(</span><span class="n">policy</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">memory_size</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">config_list</span><span class="o">=</span><span class="n">config_list_from_json</span><span class="p">(</span><span class="s2">&quot;OAI_CONFIG_LIST&quot;</span><span class="p">))</span>


<span class="n">feedback</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="c1"># This is an online optimization problem. we have the opportunity to</span>
<span class="c1"># keep changing the function with each round of interaction</span>
<span class="n">board</span> <span class="o">=</span> <span class="n">BattleshipBoard</span><span class="p">(</span><span class="n">board_size</span><span class="p">,</span> <span class="n">board_size</span><span class="p">,</span> <span class="n">num_each_type</span><span class="o">=</span><span class="n">num_each_type</span><span class="p">,</span> <span class="n">exclude_ships</span><span class="o">=</span><span class="n">exclude_ships</span><span class="p">)</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">node</span><span class="p">(</span><span class="n">board</span><span class="o">.</span><span class="n">get_shots</span><span class="p">())</span>  <span class="c1"># init observation</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
    <span class="n">GRAPH</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">policy</span><span class="o">.</span><span class="n">select_coordinate</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
        <span class="n">obs</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">terminal</span><span class="p">,</span> <span class="n">feedback</span> <span class="o">=</span> <span class="n">user_fb_for_placing_shot</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># not traced</span>
    <span class="k">except</span> <span class="n">ExecutionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>  <span class="c1"># this is a retry</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">exception_node</span>
        <span class="n">feedback</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">data</span>
        <span class="n">reward</span><span class="p">,</span> <span class="n">terminal</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">terminal</span><span class="p">:</span>
        <span class="n">board</span> <span class="o">=</span> <span class="n">BattleshipBoard</span><span class="p">(</span><span class="n">board_size</span><span class="p">,</span> <span class="n">board_size</span><span class="p">,</span> <span class="n">num_each_type</span><span class="o">=</span><span class="n">num_each_type</span><span class="p">,</span> <span class="n">exclude_ships</span><span class="o">=</span><span class="n">exclude_ships</span><span class="p">)</span>
        <span class="n">obs</span> <span class="o">=</span> <span class="n">node</span><span class="p">(</span><span class="n">board</span><span class="o">.</span><span class="n">get_shots</span><span class="p">())</span>  <span class="c1"># init observation</span>

    <span class="c1"># Update</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_feedback</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">backward</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">feedback</span><span class="p">)</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Logging</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">ExceptionNode</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">returns</span> <span class="o">=</span> <span class="n">eval_policy</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span> <span class="n">board_size</span><span class="p">,</span> <span class="n">num_each_type</span><span class="p">,</span> <span class="n">exclude_ships</span><span class="p">,</span> <span class="n">n_eval_episodes</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iteration&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;returns:&quot;</span><span class="p">,</span> <span class="n">returns</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Prompt
 
You&#39;re tasked to solve a coding/algorithm problem. You will see the instruction, the code, the documentation of each function used in the code, and the feedback about the execution result.

Specifically, a problem will be composed of the following parts:
- #Instruction: the instruction which describes the things you need to do or the question you should answer.
- #Code: the code defined in the problem.
- #Documentation: the documentation of each function used in #Code. The explanation might be incomplete and just contain high-level description. You can use the values in #Others to help infer how those functions work.
- #Variables: the input variables that you can change.
- #Constraints: the constraints or descriptions of the variables in #Variables.
- #Inputs: the values of other inputs to the code, which are not changeable.
- #Others: the intermediate values created through the code execution.
- #Outputs: the result of the code output.
- #Feedback: the feedback about the code&#39;s execution result.

In #Variables, #Inputs, #Outputs, and #Others, the format is:

&lt;data_type&gt; &lt;variable_name&gt; = &lt;value&gt;

If &lt;type&gt; is (code), it means &lt;value&gt; is the source code of a python code, which may include docstring and definitions.

Output_format: Your output should be in the following json format, satisfying the json syntax:

{{
&quot;reasoning&quot;: &lt;Your reasoning&gt;,
&quot;answer&quot;: &lt;Your answer&gt;,
&quot;suggestion&quot;: {{
    &lt;variable_1&gt;: &lt;suggested_value_1&gt;,
    &lt;variable_2&gt;: &lt;suggested_value_2&gt;,
}}
}}

In &quot;reasoning&quot;, explain the problem: 1. what the #Instruction means 2. what the #Feedback on #Output means to #Variables considering how #Variables are used in #Code and other values in #Documentation, #Inputs, #Others. 3. Reasoning about the suggested changes in #Variables (if needed) and the expected result.

If #Instruction asks for an answer, write it down in &quot;answer&quot;.

If you need to suggest a change in the values of #Variables, write down the suggested values in &quot;suggestion&quot;. Remember you can change only the values in #Variables, not others. When &lt;type&gt; of a variable is (code), you should write the new definition in the format of python code without syntax errors, and you should not change the function name or the function signature.

If no changes or answer are needed, just output TERMINATE.

Now you see problem instance:

================================

#Instruction
You need to change the &lt;value&gt; of the variables in #Variables to improve the output in accordance to #Feedback.

#Code
Policy.reason0 = eval(self=Policy0, map=list150, __code=__code1)
Policy.act0 = eval(self=Policy1, map=list150, plan=Policy.reason0, __code=__code0)

#Documentation
[Policy.act] Given a map, select a target coordinate in a game.
X denotes hits, O denotes misses, and . denotes unknown positions..

#Variables
(code) __code1:def reason(self, map):
        &quot;&quot;&quot;
        Given a map, analyze the board in a game.
        X denotes hits, O denotes misses, and . denotes unknown positions.
        &quot;&quot;&quot;
        return
(code) __code0:def act(self, map, plan):
        &quot;&quot;&quot;
        Given a map, select a target coordinate in a game.
        X denotes hits, O denotes misses, and . denotes unknown positions.
        &quot;&quot;&quot;
        return

#Constraints
(code) __code1: The code should start with:
def reason(self, map):
        &quot;&quot;&quot;
        Given a map, analyze the board in a game.
        X denotes hits, O denotes misses, and . denotes unknown positions.
        &quot;&quot;&quot;
(code) __code0: The code should start with:
def act(self, map, plan):
        &quot;&quot;&quot;
        Given a map, select a target coordinate in a game.
        X denotes hits, O denotes misses, and . denotes unknown positions.
        &quot;&quot;&quot;

#Inputs
(Policy) Policy1=&lt;__main__.Policy object at 0x000002271BB641F0&gt;
(Policy) Policy0=&lt;__main__.Policy object at 0x000002271BB641F0&gt;
(list) list150=[[&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;]]

#Others
(NoneType) Policy.reason0=None

#Outputs
(NoneType) Policy.act0=None

#Feedback:
&#39;NoneType&#39; object is not subscriptable

================================


Your response:

LLM response:
 {
&quot;reasoning&quot;: &quot;The issue here is that the provided functions &#39;__code1&#39; and &#39;__code0&#39; for &#39;reason&#39; and &#39;act&#39; methods respectively are empty and return nothing (implicitly None). This becomes problematic when &#39;Policy.act0&#39; tries to use the result of &#39;Policy.reason0&#39; as part of its logic. If &#39;Policy.reason0&#39; is None, it can&#39;t be used in the expected manner by &#39;Policy.act0&#39;, which likely attempts to subscript it or perform some operation that is not valid on a NoneType, leading to the &#39;NoneType&#39; object is not subscriptable error. To improve the output, the &#39;__code1&#39; and &#39;__code0&#39; functions need to be correctly implemented so that &#39;reason&#39; returns a valid plan that &#39;act&#39; can use. For instance, &#39;reason&#39; should analyze the given map to determine a strategic action plan (e.g., a coordinate to hit next), and &#39;act&#39; should take this plan and execute a specific action based on it.&quot;,
&quot;answer&quot;: &quot;&quot;,
&quot;suggestion&quot;: {
    &quot;__code1&quot;: &quot;def reason(self, map):\n        \&quot;\&quot;\&quot;\n        Given a map, analyze the board in a game.\n        X denotes hits, O denotes misses, and . denotes unknown positions.\n        \&quot;\&quot;\&quot;\n        # Example implementation:\n        # Analyze the map to find the first unknown position\n        for i, row in enumerate(map):\n            for j, cell in enumerate(row):\n                if cell == &#39;.&#39;:\n                    return (i, j)\n        return None&quot;,
    &quot;__code0&quot;: &quot;def act(self, map, plan):\n        \&quot;\&quot;\&quot;\n        Given a map, select a target coordinate in a game.\n        X denotes hits, O denotes misses, and . denotes unknown positions.\n        \&quot;\&quot;\&quot;\n        # Example implementation:\n        # Return the plan as is, assuming it&#39;s a valid target\n        return plan\n&quot;
}
}
Scores: 0.4801587301587302 (0.030865772194650906)
Iteration 0 returns: [0.45833333 0.45833333 0.52380952]
Prompt
 
You&#39;re tasked to solve a coding/algorithm problem. You will see the instruction, the code, the documentation of each function used in the code, and the feedback about the execution result.

Specifically, a problem will be composed of the following parts:
- #Instruction: the instruction which describes the things you need to do or the question you should answer.
- #Code: the code defined in the problem.
- #Documentation: the documentation of each function used in #Code. The explanation might be incomplete and just contain high-level description. You can use the values in #Others to help infer how those functions work.
- #Variables: the input variables that you can change.
- #Constraints: the constraints or descriptions of the variables in #Variables.
- #Inputs: the values of other inputs to the code, which are not changeable.
- #Others: the intermediate values created through the code execution.
- #Outputs: the result of the code output.
- #Feedback: the feedback about the code&#39;s execution result.

In #Variables, #Inputs, #Outputs, and #Others, the format is:

&lt;data_type&gt; &lt;variable_name&gt; = &lt;value&gt;

If &lt;type&gt; is (code), it means &lt;value&gt; is the source code of a python code, which may include docstring and definitions.

Output_format: Your output should be in the following json format, satisfying the json syntax:

{{
&quot;reasoning&quot;: &lt;Your reasoning&gt;,
&quot;answer&quot;: &lt;Your answer&gt;,
&quot;suggestion&quot;: {{
    &lt;variable_1&gt;: &lt;suggested_value_1&gt;,
    &lt;variable_2&gt;: &lt;suggested_value_2&gt;,
}}
}}

In &quot;reasoning&quot;, explain the problem: 1. what the #Instruction means 2. what the #Feedback on #Output means to #Variables considering how #Variables are used in #Code and other values in #Documentation, #Inputs, #Others. 3. Reasoning about the suggested changes in #Variables (if needed) and the expected result.

If #Instruction asks for an answer, write it down in &quot;answer&quot;.

If you need to suggest a change in the values of #Variables, write down the suggested values in &quot;suggestion&quot;. Remember you can change only the values in #Variables, not others. When &lt;type&gt; of a variable is (code), you should write the new definition in the format of python code without syntax errors, and you should not change the function name or the function signature.

If no changes or answer are needed, just output TERMINATE.

Now you see problem instance:

================================

#Instruction
You need to change the &lt;value&gt; of the variables in #Variables to improve the output in accordance to #Feedback.

#Code
eval0 = eval(self=Policy0, map=list0, __code=__code1)
eval1 = eval(self=Policy1, map=list1, plan=eval0, __code=__code0)

#Documentation
[eval] This operator eval(__code, *args, **kwargs) evaluates the code block, where __code is the code (str) and *args and **kwargs are the arguments of the function. The output is the result of the evaluation, i.e., __code(*args, **kwargs).

#Variables
(code) __code1:def reason(self, map):
        &quot;&quot;&quot;
        Given a map, analyze the board in a game.
        X denotes hits, O denotes misses, and . denotes unknown positions.
        &quot;&quot;&quot;
        # Example implementation:
        # Analyze the map to find the first unknown position
        for i, row in enumerate(map):
            for j, cell in enumerate(row):
                if cell == &#39;.&#39;:
                    return (i, j)
        return None
(code) __code0:def act(self, map, plan):
        &quot;&quot;&quot;
        Given a map, select a target coordinate in a game.
        X denotes hits, O denotes misses, and . denotes unknown positions.
        &quot;&quot;&quot;
        # Example implementation:
        # Return the plan as is, assuming it&#39;s a valid target
        return plan


#Constraints
(code) __code1: The code should start with:
def reason(self, map):
        &quot;&quot;&quot;
        Given a map, analyze the board in a game.
        X denotes hits, O denotes misses, and . denotes unknown positions.
        &quot;&quot;&quot;
(code) __code0: The code should start with:
def act(self, map, plan):
        &quot;&quot;&quot;
        Given a map, select a target coordinate in a game.
        X denotes hits, O denotes misses, and . denotes unknown positions.
        &quot;&quot;&quot;

#Inputs
(Policy) Policy1=&lt;__main__.Policy object at 0x000002271BB641F0&gt;
(list) list1=[[&#39;X&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;]]
(Policy) Policy0=&lt;__main__.Policy object at 0x000002271BB641F0&gt;
(list) list0=[[&#39;X&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;]]

#Others
(tuple) eval0=(0, 0)

#Outputs
(tuple) eval1=(0, 0)

#Feedback:
Got 1 reward.

================================


Your response:

LLM response:
 {
&quot;reasoning&quot;: &quot;According to the instruction, we need to improve the output based on the feedback which states &#39;Got 1 reward&#39;. This would suggest that the actions taken are correct but possibly not optimal, given the context provided is not sufficiently detailed regarding how rewards are obtained (e.g., hitting targets in a game represented by a grid). The usage of the eval() function in the code executes defined logic within __code1 and __code0 blocks for analyzing a game board and selecting a target coordinate, respectively. The __code1 block is correctly identifying the first unknown (&#39;.&#39;) position, which is (0, 1) but returns (0, 0) mistakenly due to the incorrect starting index of eval0 in #Others. The __code0 block simply returns the &#39;plan&#39; (a coordinate), demonstrating it&#39;s assumed to be a valid next action but seems misaligned with the intent of dynamically selecting the next strategy based on map analysis. To align the output with what might be considered a better strategic move or to improve the obtained reward from the action, adjustments are suggested in the logic for __code1 (initial analysis) and potentially __code nd __code1 (1, retrieving it correctly from the game analysis) while ensuring no syntax errors are introduced and the code suggestions abide by the given constraints.&quot;,
&quot;answer&quot;: &quot;&quot;,
&quot;suggestion&quot;: {
&quot;__code1&quot;: &quot;def reason(self, map):\n        \&quot;\&quot;\&quot;\n        Given a map, analyze the board in a game.\n        X denotes hits, O denotes misses, and . denotes unknown positions.\n        \&quot;\&quot;\&quot;\n        # Example implementation:\n        # Analyze the map to find the first unknown position\n        for i, row in enumerate(map):\n            for j, cell in enumerate(row):\n                if cell == &#39;.&#39;:\n                    return (i, j)\n        return None&quot;,
&quot;__code0&quot;: &quot;def act(self, map, plan):\n        \&quot;\&quot;\&quot;\n        Given a map, select a target coordinate in a game.\n        X denotes hits, O denotes misses, and . denotes unknown positions.\n        \&quot;\&quot;\&quot;\n        # Example implementation:\n        # Check if the plan is a valid target, if not, select the first unknown (&#39;.&#39;) position\n        for i, row in enumerate(map):\n            for j, cell in enumerate(row):\n                if cell == &#39;.&#39;:\n                    return (i, j)\n        return plan&quot;
}
}
Scores: 0.4716183574879227 (0.00939393066793724)
Iteration 1 returns: [0.45833333 0.47826087 0.47826087]
Prompt
 
You&#39;re tasked to solve a coding/algorithm problem. You will see the instruction, the code, the documentation of each function used in the code, and the feedback about the execution result.

Specifically, a problem will be composed of the following parts:
- #Instruction: the instruction which describes the things you need to do or the question you should answer.
- #Code: the code defined in the problem.
- #Documentation: the documentation of each function used in #Code. The explanation might be incomplete and just contain high-level description. You can use the values in #Others to help infer how those functions work.
- #Variables: the input variables that you can change.
- #Constraints: the constraints or descriptions of the variables in #Variables.
- #Inputs: the values of other inputs to the code, which are not changeable.
- #Others: the intermediate values created through the code execution.
- #Outputs: the result of the code output.
- #Feedback: the feedback about the code&#39;s execution result.

In #Variables, #Inputs, #Outputs, and #Others, the format is:

&lt;data_type&gt; &lt;variable_name&gt; = &lt;value&gt;

If &lt;type&gt; is (code), it means &lt;value&gt; is the source code of a python code, which may include docstring and definitions.

Output_format: Your output should be in the following json format, satisfying the json syntax:

{{
&quot;reasoning&quot;: &lt;Your reasoning&gt;,
&quot;answer&quot;: &lt;Your answer&gt;,
&quot;suggestion&quot;: {{
    &lt;variable_1&gt;: &lt;suggested_value_1&gt;,
    &lt;variable_2&gt;: &lt;suggested_value_2&gt;,
}}
}}

In &quot;reasoning&quot;, explain the problem: 1. what the #Instruction means 2. what the #Feedback on #Output means to #Variables considering how #Variables are used in #Code and other values in #Documentation, #Inputs, #Others. 3. Reasoning about the suggested changes in #Variables (if needed) and the expected result.

If #Instruction asks for an answer, write it down in &quot;answer&quot;.

If you need to suggest a change in the values of #Variables, write down the suggested values in &quot;suggestion&quot;. Remember you can change only the values in #Variables, not others. When &lt;type&gt; of a variable is (code), you should write the new definition in the format of python code without syntax errors, and you should not change the function name or the function signature.

If no changes or answer are needed, just output TERMINATE.

Now you see problem instance:

================================

#Instruction
You need to change the &lt;value&gt; of the variables in #Variables to improve the output in accordance to #Feedback.

#Code
eval0 = eval(self=Policy0, map=list0, __code=__code1)
eval1 = eval(self=Policy1, map=list1, plan=eval0, __code=__code0)

#Documentation
[eval] This operator eval(__code, *args, **kwargs) evaluates the code block, where __code is the code (str) and *args and **kwargs are the arguments of the function. The output is the result of the evaluation, i.e., __code(*args, **kwargs).

#Variables
(code) __code1:def reason(self, map):
        &quot;&quot;&quot;
        Given a map, analyze the board in a game.
        X denotes hits, O denotes misses, and . denotes unknown positions.
        &quot;&quot;&quot;
        # Example implementation:
        # Analyze the map to find the first unknown position
        for i, row in enumerate(map):
            for j, cell in enumerate(row):
                if cell == &#39;.&#39;:
                    return (i, j)
        return None
(code) __code0:def act(self, map, plan):
        &quot;&quot;&quot;
        Given a map, select a target coordinate in a game.
        X denotes hits, O denotes misses, and . denotes unknown positions.
        &quot;&quot;&quot;
        # Example implementation:
        # Check if the plan is a valid target, if not, select the first unknown (&#39;.&#39;) position
        for i, row in enumerate(map):
            for j, cell in enumerate(row):
                if cell == &#39;.&#39;:
                    return (i, j)
        return plan

#Constraints
(code) __code1: The code should start with:
def reason(self, map):
        &quot;&quot;&quot;
        Given a map, analyze the board in a game.
        X denotes hits, O denotes misses, and . denotes unknown positions.
        &quot;&quot;&quot;
(code) __code0: The code should start with:
def act(self, map, plan):
        &quot;&quot;&quot;
        Given a map, select a target coordinate in a game.
        X denotes hits, O denotes misses, and . denotes unknown positions.
        &quot;&quot;&quot;

#Inputs
(Policy) Policy1=&lt;__main__.Policy object at 0x000002271BB641F0&gt;
(list) list1=[[&#39;X&#39;, &#39;O&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;]]
(Policy) Policy0=&lt;__main__.Policy object at 0x000002271BB641F0&gt;
(list) list0=[[&#39;X&#39;, &#39;O&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;]]

#Others
(tuple) eval0=(0, 1)

#Outputs
(tuple) eval1=(0, 1)

#Feedback:
Got 0 reward.

================================


Your response:

LLM response:
 {
&quot;reasoning&quot;: &quot;The issue seems to lie in the act function&#39;s logic. According to the instructions, the act function should select a target coordinate in a game where &#39;X&#39; denotes hits, &#39;O&#39; denotes misses, and &#39;.&#39; denotes unknown positions. The provided __code0 for the act function incorrectly assumes that the plan (eval0) is always a valid target, but it should actually check if the target is an unknown (&#39;.&#39;) position, and if not, it should find the next available unknown position. In this case, since eval0 returns (0, 1), and the map shows that position (0, 2) is the first unknown after (0, 1), the act function should be returning (0, 2) to improve the game outcome and possibly get a reward. However, it incorrectly just checks for the first &#39;.&#39; and returns (0, 1), which is not the desired logic for selecting the next target.&quot;,
&quot;answer&quot;: &quot;&quot;,
&quot;suggestion&quot;: {
    &quot;__code0&quot;: &quot;def act(self, map, plan):\n        \&quot;\&quot;\&quot;\n        Given a map, select a target coordinate in a game.\n        X denotes hits, O denotes misses, and . denotes unknown positions.\n        \&quot;\&quot;\&quot;\n        # Check if the plan points to an unknown position; otherwise, select the next.\n        i, j = plan\n        if map[i][j] == &#39;.&#39;:\n            return (i, j + 1)\n        else:\n            for x, row in enumerate(map):\n                for y, cell in enumerate(row):\n                    if cell == &#39;.&#39;:\n                        return (x, y)\n        return plan&quot;
}
}
Scores: 0.013888888888888888 (0.019641855032959652)
Iteration 2 returns: [0.04166667 0.         0.        ]
Prompt
 
You&#39;re tasked to solve a coding/algorithm problem. You will see the instruction, the code, the documentation of each function used in the code, and the feedback about the execution result.

Specifically, a problem will be composed of the following parts:
- #Instruction: the instruction which describes the things you need to do or the question you should answer.
- #Code: the code defined in the problem.
- #Documentation: the documentation of each function used in #Code. The explanation might be incomplete and just contain high-level description. You can use the values in #Others to help infer how those functions work.
- #Variables: the input variables that you can change.
- #Constraints: the constraints or descriptions of the variables in #Variables.
- #Inputs: the values of other inputs to the code, which are not changeable.
- #Others: the intermediate values created through the code execution.
- #Outputs: the result of the code output.
- #Feedback: the feedback about the code&#39;s execution result.

In #Variables, #Inputs, #Outputs, and #Others, the format is:

&lt;data_type&gt; &lt;variable_name&gt; = &lt;value&gt;

If &lt;type&gt; is (code), it means &lt;value&gt; is the source code of a python code, which may include docstring and definitions.

Output_format: Your output should be in the following json format, satisfying the json syntax:

{{
&quot;reasoning&quot;: &lt;Your reasoning&gt;,
&quot;answer&quot;: &lt;Your answer&gt;,
&quot;suggestion&quot;: {{
    &lt;variable_1&gt;: &lt;suggested_value_1&gt;,
    &lt;variable_2&gt;: &lt;suggested_value_2&gt;,
}}
}}

In &quot;reasoning&quot;, explain the problem: 1. what the #Instruction means 2. what the #Feedback on #Output means to #Variables considering how #Variables are used in #Code and other values in #Documentation, #Inputs, #Others. 3. Reasoning about the suggested changes in #Variables (if needed) and the expected result.

If #Instruction asks for an answer, write it down in &quot;answer&quot;.

If you need to suggest a change in the values of #Variables, write down the suggested values in &quot;suggestion&quot;. Remember you can change only the values in #Variables, not others. When &lt;type&gt; of a variable is (code), you should write the new definition in the format of python code without syntax errors, and you should not change the function name or the function signature.

If no changes or answer are needed, just output TERMINATE.

Now you see problem instance:

================================

#Instruction
You need to change the &lt;value&gt; of the variables in #Variables to improve the output in accordance to #Feedback.

#Code
eval0 = eval(self=Policy0, map=list0, __code=__code1)
eval1 = eval(self=Policy1, map=list1, plan=eval0, __code=__code0)

#Documentation
[eval] This operator eval(__code, *args, **kwargs) evaluates the code block, where __code is the code (str) and *args and **kwargs are the arguments of the function. The output is the result of the evaluation, i.e., __code(*args, **kwargs).

#Variables
(code) __code1:def reason(self, map):
        &quot;&quot;&quot;
        Given a map, analyze the board in a game.
        X denotes hits, O denotes misses, and . denotes unknown positions.
        &quot;&quot;&quot;
        # Example implementation:
        # Analyze the map to find the first unknown position
        for i, row in enumerate(map):
            for j, cell in enumerate(row):
                if cell == &#39;.&#39;:
                    return (i, j)
        return None
(code) __code0:def act(self, map, plan):
        &quot;&quot;&quot;
        Given a map, select a target coordinate in a game.
        X denotes hits, O denotes misses, and . denotes unknown positions.
        &quot;&quot;&quot;
        # Check if the plan points to an unknown position; otherwise, select the next.
        i, j = plan
        if map[i][j] == &#39;.&#39;:
            return (i, j + 1)
        else:
            for x, row in enumerate(map):
                for y, cell in enumerate(row):
                    if cell == &#39;.&#39;:
                        return (x, y)
        return plan

#Constraints
(code) __code1: The code should start with:
def reason(self, map):
        &quot;&quot;&quot;
        Given a map, analyze the board in a game.
        X denotes hits, O denotes misses, and . denotes unknown positions.
        &quot;&quot;&quot;
(code) __code0: The code should start with:
def act(self, map, plan):
        &quot;&quot;&quot;
        Given a map, select a target coordinate in a game.
        X denotes hits, O denotes misses, and . denotes unknown positions.
        &quot;&quot;&quot;

#Inputs
(Policy) Policy1=&lt;__main__.Policy object at 0x000002271BB641F0&gt;
(list) list1=[[&#39;X&#39;, &#39;O&#39;, &#39;.&#39;, &#39;O&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;]]
(Policy) Policy0=&lt;__main__.Policy object at 0x000002271BB641F0&gt;
(list) list0=[[&#39;X&#39;, &#39;O&#39;, &#39;.&#39;, &#39;O&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;], [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;]]

#Others
(tuple) eval0=(0, 2)

#Outputs
(tuple) eval1=(0, 3)

#Feedback:
Got 0 reward.

================================


Your response:

LLM response:
 {
&quot;reasoning&quot;: &quot;The instruction implies that the issue lies with the actions defined in __code1 and __code0. Given the maps and the evaluation output, it looks like the evaluation is not meeting the intended outcome, which is likely to find the next unknown position to target and get a reward. __code1 correctly identifies the first unknown position on the map, and eval0 reflects this with (0, 2). However, __code0 should select the target coordinate based on some criteria of success, but it currently just moves to the next coordinate from the plan given by eval0, without checking if the move makes strategic sense or leads to a reward. Given the feedback &#39;Got 0 reward&#39;, the move made by __code0 from (0, 2) to (0, 3) might not be an optimal strategy. It seems __code0 fails to define a strategic move after identifying the first unknown position. A better strategy might involve checking if moving to a certain position increases the chance of hitting a target (&#39;X&#39;) or avoiding misses (&#39;O&#39;).&quot;,
&quot;answer&quot;: &quot;&quot;,
&quot;suggestion&quot;: {
&quot;__code0&quot;: &quot;def act(self, map, plan):\n        \&quot;\&quot;\&quot;\n        Given a map, select a target coordinate in a game.\n        X denotes hits, O denotes misses, and . denotes unknown positions.\n        \&quot;\&quot;\&quot;\n        i, j = plan\n        # Implement a smarter strategy to find the next best move.\n        # This involves looking for the next &#39;.&#39; in a row wise manner.\n        for x in range(i, len(map)):\n            if &#39;.&#39; in map[x]:\n                for y in range(len(map[x])):\n                    if map[x][y] == &#39;.&#39;:\n                        return (x, y)\n        return plan&quot;
}
}
Scores: 0.4583333333333333 (0.0)
Iteration 3 returns: [0.45833333 0.45833333 0.45833333]
</pre></div>
</div>
</div>
</div>
<p>This completes the tutorial on using the Trace package for optimizing multiple codes in an episodic setting. Happy optimizing!</p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./examples/game"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../../tutorials/error_handling_tutorial.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Error Handling</p>
      </div>
    </a>
    <a class="right-next"
       href="joint_prompt_optimization.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Multi-Agent: Negotiation Arena</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Single Agent: Battleship</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-and-installation">Setup and Installation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#environment-setup">Environment Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wrap-the-environment-into-a-battleshipboard-class">Wrap the environment into a BattleshipBoard class</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-a-policy-class-with-multiple-trainable-functions">Define a Policy class with multiple trainable functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-functions-to-rollout-and-evaluate-the-policy">Helper Functions to rollout and evaluate the policy</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-the-initial-policy">Creating the initial policy</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#putting-it-all-together">Putting it all together</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ching-An Cheng, Allen Nie, Adith Swaminathan
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024 Trace Team.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <a href='mailto:chinganc@microsoft.com'>Contact Us</a> | <a href='http://go.microsoft.com/fwlink/?LinkId=521839'>Privacy &amp; Cookies</a> | <a href='https://go.microsoft.com/fwlink/?linkid=2259814'>Consumer Health Privacy</a> | <a href='https://go.microsoft.com/fwlink/?LinkID=206977'>Terms Of Use</a> | <a href='https://www.microsoft.com/trademarks'>Trademarks</a>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>