
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Optimization &#8212; Trace</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../_static/compatibility.css?v=fb730901" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script data-domain="microsoft.github.io/trace" defer="defer" src="https://plausible.io/js/script.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/optimization_tutorial';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Error Handling" href="error_handling_tutorial.html" />
    <link rel="prev" title="Basics" href="basic_tutorial.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/trace_logo.png" class="logo__image only-light" alt="Trace - Home"/>
    <script>document.write(`<img src="../_static/trace_logo.png" class="logo__image only-dark" alt="Trace - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    üéØ Trace
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">üí°Quick Start</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../quickstart/installation.html">üåê  Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/quick_start.html">‚ö°Ô∏è First: 5-Minute Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/quick_start_2.html">üöÄ Next: Adaptive Agent</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/virtualhome.html">ü§Ø Finally: Emergent Behaviors</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">üìöTutorials</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="basic_tutorial.html">Basics</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="error_handling_tutorial.html">Error Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_optimizers.html">Building Custom Optimizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="minibatch.html">Batch Optimization</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Agent Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../examples/game/battleship.html">Single Agent: Battleship</a></li>


<li class="toctree-l1"><a class="reference internal" href="../examples/game/negotiation_arena.html">Multi-Agent: Negotiation Arena</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NLP Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../examples/nlp/bigbench_hard.html">BigBench-Hard</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Robotics Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../examples/robotics/metaworld.html">Meta-World</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">FAQ</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../faq/faq.html">FAQ</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">üìñ API Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/opto.html">opto</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/opto.optimizers.html">opto.optimizers</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/opto.optimizers.buffers.html">opto.optimizers.buffers</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.optimizers.buffers.FIFOBuffer.html">opto.optimizers.buffers.FIFOBuffer</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/opto.optimizers.opro.html">opto.optimizers.opro</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.optimizers.opro.OPRO.html">opto.optimizers.opro.OPRO</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/opto.optimizers.optimizer.html">opto.optimizers.optimizer</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.optimizers.optimizer.AbstractOptimizer.html">opto.optimizers.optimizer.AbstractOptimizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.optimizers.optimizer.Optimizer.html">opto.optimizers.optimizer.Optimizer</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/opto.optimizers.optoprime.html">opto.optimizers.optoprime</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.optimizers.optoprime.get_fun_name.html">opto.optimizers.optoprime.get_fun_name</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.optimizers.optoprime.node_to_function_feedback.html">opto.optimizers.optoprime.node_to_function_feedback</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.optimizers.optoprime.repr_function_call.html">opto.optimizers.optoprime.repr_function_call</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.optimizers.optoprime.FunctionFeedback.html">opto.optimizers.optoprime.FunctionFeedback</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.optimizers.optoprime.OptoPrime.html">opto.optimizers.optoprime.OptoPrime</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.optimizers.optoprime.ProblemInstance.html">opto.optimizers.optoprime.ProblemInstance</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/opto.optimizers.textgrad.html">opto.optimizers.textgrad</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.optimizers.textgrad.GRADIENT_MULTIPART_TEMPLATE.html">opto.optimizers.textgrad.GRADIENT_MULTIPART_TEMPLATE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.optimizers.textgrad.GRADIENT_OF_RESULTS_INSTRUCTION.html">opto.optimizers.textgrad.GRADIENT_OF_RESULTS_INSTRUCTION</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.optimizers.textgrad.construct_reduce_prompt.html">opto.optimizers.textgrad.construct_reduce_prompt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.optimizers.textgrad.construct_tgd_prompt.html">opto.optimizers.textgrad.construct_tgd_prompt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.optimizers.textgrad.get_short_value.html">opto.optimizers.textgrad.get_short_value</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.optimizers.textgrad.rm_node_attrs.html">opto.optimizers.textgrad.rm_node_attrs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.optimizers.textgrad.GradientInfo.html">opto.optimizers.textgrad.GradientInfo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.optimizers.textgrad.TextGrad.html">opto.optimizers.textgrad.TextGrad</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/opto.optimizers.utils.html">opto.optimizers.utils</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.optimizers.utils.print_color.html">opto.optimizers.utils.print_color</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/opto.trace.html">opto.trace</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/opto.trace.stop_tracing.html">opto.trace.stop_tracing</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/opto.trace.broadcast.html">opto.trace.broadcast</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.broadcast.apply_op.html">opto.trace.broadcast.apply_op</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.broadcast.recursive_conversion.html">opto.trace.broadcast.recursive_conversion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/opto.trace.bundle.html">opto.trace.bundle</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/opto.trace.containers.html">opto.trace.containers</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.containers.trainable_method.html">opto.trace.containers.trainable_method</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.containers.Map.html">opto.trace.containers.Map</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.containers.NodeContainer.html">opto.trace.containers.NodeContainer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.containers.ParameterContainer.html">opto.trace.containers.ParameterContainer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.containers.Seq.html">opto.trace.containers.Seq</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/opto.trace.errors.html">opto.trace.errors</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.errors.ExecutionError.html">opto.trace.errors.ExecutionError</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.errors.TraceMissingInputsError.html">opto.trace.errors.TraceMissingInputsError</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/opto.trace.iterators.html">opto.trace.iterators</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.iterators.iterate.html">opto.trace.iterators.iterate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.iterators.DictIterable.html">opto.trace.iterators.DictIterable</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.iterators.SeqIterable.html">opto.trace.iterators.SeqIterable</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/opto.trace.modules.html">opto.trace.modules</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.modules.model.html">opto.trace.modules.model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.modules.Module.html">opto.trace.modules.Module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/opto.trace.nodes.html">opto.trace.nodes</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.nodes.get_op_name.html">opto.trace.nodes.get_op_name</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.nodes.node-function.html">opto.trace.nodes.node</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.nodes.AbstractNode.html">opto.trace.nodes.AbstractNode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.nodes.ExceptionNode.html">opto.trace.nodes.ExceptionNode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.nodes.Graph.html">opto.trace.nodes.Graph</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.nodes.MessageNode.html">opto.trace.nodes.MessageNode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.nodes.Node.html">opto.trace.nodes.Node</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.nodes.NodeVizStyleGuide.html">opto.trace.nodes.NodeVizStyleGuide</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.nodes.NodeVizStyleGuideColorful.html">opto.trace.nodes.NodeVizStyleGuideColorful</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.nodes.ParameterNode.html">opto.trace.nodes.ParameterNode</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/opto.trace.operators.html">opto.trace.operators</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.operators.identity.html">opto.trace.operators.identity</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/opto.trace.propagators.html">opto.trace.propagators</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.propagators.graph_propagator.html">opto.trace.propagators.graph_propagator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.propagators.propagators.html">opto.trace.propagators.propagators</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/opto.trace.utils.html">opto.trace.utils</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.utils.contain.html">opto.trace.utils.contain</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.utils.escape_json_nested_quotes.html">opto.trace.utils.escape_json_nested_quotes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.utils.for_all_methods.html">opto.trace.utils.for_all_methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.utils.parse_eqs_to_dict.html">opto.trace.utils.parse_eqs_to_dict</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.utils.remove_non_ascii.html">opto.trace.utils.remove_non_ascii</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.utils.render_opt_step.html">opto.trace.utils.render_opt_step</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.utils.sum_feedback.html">opto.trace.utils.sum_feedback</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.trace.utils.test_json_quote_escaper.html">opto.trace.utils.test_json_quote_escaper</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/opto.utils.html">opto.utils</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/opto.utils.llm.html">opto.utils.llm</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.utils.llm.auto_construct_oai_config_list_from_env.html">opto.utils.llm.auto_construct_oai_config_list_from_env</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.utils.llm.AbstractModel.html">opto.utils.llm.AbstractModel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/opto.utils.llm.AutoGenLLM.html">opto.utils.llm.AutoGenLLM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/opto.version.html">opto.version</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/microsoft/Trace/blob/website/docs/tutorials/optimization_tutorial.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>



<a href="https://github.com/microsoft/Trace" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/tutorials/optimization_tutorial.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Optimization</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#backpropagation">Backpropagation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-of-full-optimization-loop">Example of Full Optimization Loop</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-constraints">Adding constraints</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-of-optimizing-strings">Example of optimizing strings</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-of-optimizing-functions">Example of optimizing functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-of-hyper-parameter-optimization-for-ml-models">Example of hyper-parameter optimization for ML models</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="optimization">
<h1>Optimization<a class="headerlink" href="#optimization" title="Link to this heading">#</a></h1>
<p>Here we show a small example of how to apply <code class="docutils literal notranslate"><span class="pre">trace</span></code> to optimize python objects based on language feedback. Here we want to change the input to function <code class="docutils literal notranslate"><span class="pre">foobar</span></code> such that output is large enough. <code class="docutils literal notranslate"><span class="pre">foobar</span></code> is a function that is composed of <code class="docutils literal notranslate"><span class="pre">foo</span></code> based on built-in operators and <code class="docutils literal notranslate"><span class="pre">bar</span></code> which is a blackbox function, whose information is only given via the docstring.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">pip</span> install trace-opt
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">opto</span>
<span class="kn">from</span> <span class="nn">opto.trace</span> <span class="kn">import</span> <span class="n">bundle</span><span class="p">,</span> <span class="n">node</span>
<span class="kn">from</span> <span class="nn">opto.optimizers</span> <span class="kn">import</span> <span class="n">OptoPrime</span>
<span class="kn">from</span> <span class="nn">opto.trace.nodes</span> <span class="kn">import</span> <span class="n">GRAPH</span>


<span class="k">def</span> <span class="nf">blackbox</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">x</span> <span class="o">*</span> <span class="mi">2</span>


<span class="nd">@bundle</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="s2">&quot;This is a test function, which does negative scaling.&quot;</span>
    <span class="k">return</span> <span class="n">blackbox</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>


<span class="c1"># foobar is a composition of custom function and built-in functions</span>


<span class="k">def</span> <span class="nf">foobar</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">foo</span><span class="p">(</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">user</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;The number needs to be larger.&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Success.&quot;</span>
</pre></div>
</div>
</div>
</div>
<section id="backpropagation">
<h2>Backpropagation<a class="headerlink" href="#backpropagation" title="Link to this heading">#</a></h2>
<p>We apply <code class="docutils literal notranslate"><span class="pre">FunctionOptimizer</span></code> to change the input to the function <code class="docutils literal notranslate"><span class="pre">foobar</span></code> such that the simulated user is satisfied. To this end, we backpropagated the user‚Äôs language feedback about the output, through the graph that connects the input to the output.</p>
<p>We use helper functions from <a class="reference external" href="https://github.com/microsoft/autogen">AutoGen</a> to call LLMs to interpret the user‚Äôs language feedback. Before running the cell below, please copy <code class="docutils literal notranslate"><span class="pre">OAI_CONFIG_LIST_sample</span></code> from the root folder of this repository to the current folder, rename it to <code class="docutils literal notranslate"><span class="pre">OAI_CONFIG_LIST</span></code>, and set the correct configuration for LLMs in there.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">autogen</span>

<span class="c1"># One-step optimization example</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">node</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">OptoPrime</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="n">config_list</span><span class="o">=</span><span class="n">autogen</span><span class="o">.</span><span class="n">config_list_from_json</span><span class="p">(</span><span class="s2">&quot;OAI_CONFIG_LIST&quot;</span><span class="p">))</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">foobar</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">feedback</span> <span class="o">=</span> <span class="n">user</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">optimizer</span><span class="o">.</span><span class="n">zero_feedback</span><span class="p">()</span>
<span class="n">optimizer</span><span class="o">.</span><span class="n">backward</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">feedback</span><span class="p">,</span> <span class="n">visualize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># this is equivalent to the line below</span>
<span class="c1"># output.backward(feedback, propagator=optimizer.propagator, visualize=visualize)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/594b30edb7b4ca7b9331d8beaecdda60b63a87d64ffc9405d820b749481fc711.svg" src="../_images/594b30edb7b4ca7b9331d8beaecdda60b63a87d64ffc9405d820b749481fc711.svg" /></div>
</div>
<p>The propagated feedback contains graph structure, data of the nodes in the graph, and the transformation used in the graph. They are presented in a python-like syntax.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">opto.optimizers.optoprime</span> <span class="kn">import</span> <span class="n">node_to_function_feedback</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Function Feedback&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">feedback</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">f_feedback</span> <span class="o">=</span> <span class="n">node_to_function_feedback</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Graph:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">kk</span><span class="p">,</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">f_feedback</span><span class="o">.</span><span class="n">graph</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">kk</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">vv</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Roots:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">kk</span><span class="p">,</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">f_feedback</span><span class="o">.</span><span class="n">roots</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">kk</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">vv</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Others:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">kk</span><span class="p">,</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">f_feedback</span><span class="o">.</span><span class="n">others</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">kk</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">vv</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Documentation:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">kk</span><span class="p">,</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">f_feedback</span><span class="o">.</span><span class="n">documentation</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">kk</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">vv</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Output:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">kk</span><span class="p">,</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">f_feedback</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">kk</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">vv</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;User Feedback:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">f_feedback</span><span class="o">.</span><span class="n">user_feedback</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Function Feedback
Graph:
  1: bar0 = bar(x=float0)
  2: add0 = add(x=bar0, y=int0)
  3: multiply0 = multiply(x=bar0, y=add0)
Roots:
  float0: (-1.0, None)
  int0: (1, None)
Others:
  bar0: (2.0, None)
  add0: (3.0, None)
Documentation:
  bar: [bar] This is a test function, which does negative scaling..
  add: [add] This is an add operator of x and y. .
  multiply: [multiply] This is a multiply operator of x and y. .
Output:
  multiply0: (6.0, None)
User Feedback:
  The number needs to be larger.
</pre></div>
</div>
</div>
</div>
<p>Once the feedback is propagated, we can call the optimizer to change the variable based on the feedback.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">old_variable</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">data</span>
<span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">After step&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;old variable&quot;</span><span class="p">,</span> <span class="n">old_variable</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;new variable&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Prompt
 
You&#39;re tasked to solve a coding/algorithm problem. You will see the instruction, the code, the documentation of each function used in the code, and the feedback about the execution result.

Specifically, a problem will be composed of the following parts:
- #Instruction: the instruction which describes the things you need to do or the question you should answer.
- #Code: the code defined in the problem.
- #Documentation: the documentation of each function used in #Code. The explanation might be incomplete and just contain high-level description. You can use the values in #Others to help infer how those functions work.
- #Variables: the input variables that you can change.
- #Constraints: the constraints or descriptions of the variables in #Variables.
- #Inputs: the values of other inputs to the code, which are not changeable.
- #Others: the intermediate values created through the code execution.
- #Outputs: the result of the code output.
- #Feedback: the feedback about the code&#39;s execution result.

In #Variables, #Inputs, #Outputs, and #Others, the format is:

&lt;data_type&gt; &lt;variable_name&gt; = &lt;value&gt;

If &lt;type&gt; is (code), it means &lt;value&gt; is the source code of a python code, which may include docstring and definitions.

Output_format: Your output should be in the following json format, satisfying the json syntax:

{{
&quot;reasoning&quot;: &lt;Your reasoning&gt;,
&quot;answer&quot;: &lt;Your answer&gt;,
&quot;suggestion&quot;: {{
    &lt;variable_1&gt;: &lt;suggested_value_1&gt;,
    &lt;variable_2&gt;: &lt;suggested_value_2&gt;,
}}
}}

In &quot;reasoning&quot;, explain the problem: 1. what the #Instruction means 2. what the #Feedback on #Output means to #Variables considering how #Variables are used in #Code and other values in #Documentation, #Inputs, #Others. 3. Reasoning about the suggested changes in #Variables (if needed) and the expected result.

If #Instruction asks for an answer, write it down in &quot;answer&quot;.

If you need to suggest a change in the values of #Variables, write down the suggested values in &quot;suggestion&quot;. Remember you can change only the values in #Variables, not others. When &lt;type&gt; of a variable is (code), you should write the new definition in the format of python code without syntax errors, and you should not change the function name or the function signature.

If no changes or answer are needed, just output TERMINATE.

Now you see problem instance:

================================

#Instruction
You need to change the &lt;value&gt; of the variables in #Variables to improve the output in accordance to #Feedback.

#Code
bar0 = bar(x=float0)
add0 = add(x=bar0, y=int0)
multiply0 = multiply(x=bar0, y=add0)

#Documentation
[bar] This is a test function, which does negative scaling..
[add] This is an add operator of x and y. .
[multiply] This is a multiply operator of x and y. .

#Variables
(float) float0=-1.0

#Constraints


#Inputs
(int) int0=1

#Others
(float) bar0=2.0
(float) add0=3.0

#Outputs
(float) multiply0=6.0

#Feedback
The number needs to be larger.

================================


Your response:

LLM response:
 {
    &quot;reasoning&quot;: &quot;From the provided code, the procedures are as follows:\n1. A function &#39;bar&#39; performs a transformation on &#39;float0&#39; and returns &#39;bar0&#39;.\n2. A function &#39;add&#39; sums &#39;bar0&#39; with &#39;int0&#39; resulting in &#39;add0&#39;.\n3. Finally, &#39;multiply&#39; takes the products of &#39;bar0&#39; and &#39;add0&#39; resulting in &#39;multiply0&#39;.\nGiven the feedback to make the output (&#39;multiply0&#39;) larger, we need to analyze how changes in &#39;float0&#39; impact &#39;bar0&#39; and accordingly &#39;add0&#39; and &#39;multiply0&#39;. The exact operation performed by &#39;bar&#39; is not explicitly stated, but given that the output is positive when the input is negative, it suggests a negation or similar transformation with a scaling. Adjusting &#39;float0&#39; to a more negative value might lead to an equivalence in &#39;bar0&#39; being more positive if the function is a simple negation or -x transformation. Increasing this magnitude should, in turn, increase &#39;add0&#39; and therefore &#39;multiply0&#39;. Changing &#39;float0&#39; from -1.0 to a more negative value such as -2.0 would likely achieve a larger result for &#39;multiply0&#39;.&quot;,
    &quot;suggestion&quot;: {
        &quot;float0&quot;: -2.0
    }
}

After step
old variable -1.0
new variable -2.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="example-of-full-optimization-loop">
<h2>Example of Full Optimization Loop<a class="headerlink" href="#example-of-full-optimization-loop" title="Link to this heading">#</a></h2>
<p>We can apply the steps above repeatedly to create a training loop to optimize the variable according to the user. Notice because of the way <code class="docutils literal notranslate"><span class="pre">foobar</span></code> works, the optimizer actually needs to change the input to be lower in order to make the output to be larger (which is what the user suggests).</p>
<p>This is a non-trivial problem, becasue the optimizer sees only</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">blackbox</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">blackbox</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>and the hint/docstring <code class="docutils literal notranslate"><span class="pre">&quot;This</span> <span class="pre">is</span> <span class="pre">a</span> <span class="pre">test</span> <span class="pre">function,</span> <span class="pre">which</span> <span class="pre">does</span> <span class="pre">scaling</span> <span class="pre">and</span> <span class="pre">negation.&quot;</span></code> about how <code class="docutils literal notranslate"><span class="pre">blackbox</span></code> works. The optimizer needs to figure out how to change the input based on this vague information.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A small example of how to use the optimizer in a loop</span>
<span class="n">GRAPH</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">node</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">OptoPrime</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="n">config_list</span><span class="o">=</span><span class="n">autogen</span><span class="o">.</span><span class="n">config_list_from_json</span><span class="p">(</span><span class="s2">&quot;OAI_CONFIG_LIST&quot;</span><span class="p">))</span>

<span class="n">history</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
<span class="n">feedback</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="k">while</span> <span class="n">feedback</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;Success.&quot;</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">foobar</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">feedback</span> <span class="o">=</span> <span class="n">user</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_feedback</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">backward</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">feedback</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;variable=</span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="si">}</span><span class="s2">, output=</span><span class="si">{</span><span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="si">}</span><span class="s2">, feedback=</span><span class="si">{</span><span class="n">feedback</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># logging</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># logging</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;History&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">history</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>variable=-1.0, output=6.0, feedback=The number needs to be larger.
variable=-2.0, output=20.0, feedback=The number needs to be larger.
variable=-1.0, output=6.0, feedback=The number needs to be larger.
variable=-2.0, output=20.0, feedback=The number needs to be larger.
variable=-4.0, output=72.0, feedback=Success.
History
  0: -1.0
  1: -2.0
  2: -1.0
  3: -2.0
  4: -4.0
  5: -4.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="adding-constraints">
<h2>Adding constraints<a class="headerlink" href="#adding-constraints" title="Link to this heading">#</a></h2>
<p>We can add constraints to parameter nodes to guide the optimizer. In this small example, the constraint info helps save one optimization step.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A small example of how to include constraints on parameters</span>
<span class="n">GRAPH</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">node</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">constraint</span><span class="o">=</span><span class="s2">&quot;The value should be greater than 2.0&quot;</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">OptoPrime</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="n">config_list</span><span class="o">=</span><span class="n">autogen</span><span class="o">.</span><span class="n">config_list_from_json</span><span class="p">(</span><span class="s2">&quot;OAI_CONFIG_LIST&quot;</span><span class="p">))</span>

<span class="n">history</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
<span class="n">feedback</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="k">while</span> <span class="n">feedback</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;Success.&quot;</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">foobar</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">feedback</span> <span class="o">=</span> <span class="n">user</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_feedback</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">backward</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">feedback</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;variable=</span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="si">}</span><span class="s2">, output=</span><span class="si">{</span><span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="si">}</span><span class="s2">, feedback=</span><span class="si">{</span><span class="n">feedback</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># logging</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># logging</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;History&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">history</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>variable=-1.0, output=6.0, feedback=The number needs to be larger.
variable=3.0, output=30.0, feedback=The number needs to be larger.
variable=4.0, output=56.0, feedback=Success.
History
  0: -1.0
  1: 3.0
  2: 4.0
  3: 4.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="example-of-optimizing-strings">
<h2>Example of optimizing strings<a class="headerlink" href="#example-of-optimizing-strings" title="Link to this heading">#</a></h2>
<p>Below is a similar example, except the variable is written in text and is converted by a poor converter to numbers before inputting to <code class="docutils literal notranslate"><span class="pre">foo</span></code> and <code class="docutils literal notranslate"><span class="pre">bar</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@bundle</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">convert_english_to_numbers</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This is a function that converts English to numbers. This function has limited ability.&quot;&quot;&quot;</span>
    <span class="c1"># remove speical characters, like, &quot;, &amp;, etc.</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>  <span class="c1"># Convert string to integer</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="c1"># Convert intergers written in Engligsh in [-10, 10] to numbers</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;negative ten&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">10</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;negative nine&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">9</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;negative eight&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">8</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;negative seven&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">7</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;negative six&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">6</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;negative five&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">5</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;negative four&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">4</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;negative three&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">3</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;negative two&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">2</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;negative one&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;zero&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;one&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;two&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;three&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">3</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;four&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">4</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;five&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">5</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;six&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">6</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;seven&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">7</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;eight&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">8</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;nine&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">9</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;ten&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">10</span>
    <span class="k">return</span> <span class="s2">&quot;FAIL&quot;</span>


<span class="k">def</span> <span class="nf">user</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;FAIL&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;The text cannot be converted to a number.&quot;</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;The number needs to be larger.&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Success.&quot;</span>


<span class="k">def</span> <span class="nf">foobar_text</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">convert_english_to_numbers</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">data</span> <span class="o">==</span> <span class="s2">&quot;FAIL&quot;</span><span class="p">:</span>  <span class="c1"># This is not traced</span>
        <span class="k">return</span> <span class="n">output</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">foo</span><span class="p">(</span><span class="n">bar</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GRAPH</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">node</span><span class="p">(</span><span class="s2">&quot;negative point one&quot;</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">OptoPrime</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="n">config_list</span><span class="o">=</span><span class="n">autogen</span><span class="o">.</span><span class="n">config_list_from_json</span><span class="p">(</span><span class="s2">&quot;OAI_CONFIG_LIST&quot;</span><span class="p">))</span>

<span class="n">history</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
<span class="n">feedback</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="k">while</span> <span class="n">feedback</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;Success.&quot;</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">foobar_text</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">feedback</span> <span class="o">=</span> <span class="n">user</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_feedback</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">backward</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">feedback</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;variable=</span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="si">}</span><span class="s2">, output=</span><span class="si">{</span><span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="si">}</span><span class="s2">, feedback=</span><span class="si">{</span><span class="n">feedback</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># logging</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># logging</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;History&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">history</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>variable=negative point one, output=FAIL, feedback=The text cannot be converted to a number.
variable=minus one tenth, output=FAIL, feedback=The text cannot be converted to a number.
variable=-0.1, output=FAIL, feedback=The text cannot be converted to a number.
variable=one, output=2, feedback=The number needs to be larger.
variable=three, output=30, feedback=The number needs to be larger.
variable=four, output=56, feedback=Success.
History
  0: negative point one
  1: minus one tenth
  2: -0.1
  3: one
  4: three
  5: four
  6: four
</pre></div>
</div>
</div>
</div>
</section>
<section id="example-of-optimizing-functions">
<h2>Example of optimizing functions<a class="headerlink" href="#example-of-optimizing-functions" title="Link to this heading">#</a></h2>
<p>We can use <code class="docutils literal notranslate"><span class="pre">trace</span></code> to optimize python function code directly. This can be achieved by setting <code class="docutils literal notranslate"><span class="pre">trainable=True</span></code> when decorating a custom function by <code class="docutils literal notranslate"><span class="pre">&#64;bundle</span></code>. This would create a <code class="docutils literal notranslate"><span class="pre">ParameterNode</span></code> in the operator, which can be accessed by the <code class="docutils literal notranslate"><span class="pre">parameter</span></code> attribute of the decorated function. It can be used like any other parameters and sent to the optimizer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GRAPH</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">user</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">output</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Success.&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Try again. The output should be negative&quot;</span>


<span class="c1"># We make this function as a parameter that can be optimized.</span>


<span class="nd">@bundle</span><span class="p">(</span><span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_fun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test function&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>


<span class="n">x</span> <span class="o">=</span> <span class="n">node</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">OptoPrime</span><span class="p">([</span><span class="n">my_fun</span><span class="o">.</span><span class="n">parameter</span><span class="p">],</span> <span class="n">config_list</span><span class="o">=</span><span class="n">autogen</span><span class="o">.</span><span class="n">config_list_from_json</span><span class="p">(</span><span class="s2">&quot;OAI_CONFIG_LIST&quot;</span><span class="p">))</span>

<span class="n">feedback</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="k">while</span> <span class="n">feedback</span> <span class="o">!=</span> <span class="s2">&quot;Success.&quot;</span><span class="p">:</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">my_fun</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">feedback</span> <span class="o">=</span> <span class="n">user</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_feedback</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">backward</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">feedback</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;output=</span><span class="si">{</span><span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="si">}</span><span class="s2">, feedback=</span><span class="si">{</span><span class="n">feedback</span><span class="si">}</span><span class="s2">, variables=</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># logging</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">parameters</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>output=2, feedback=Try again. The output should be negative, variables=

__code:0 def my_fun(x):
    &quot;&quot;&quot;Test function&quot;&quot;&quot;
    return x**2 + 1
output=0, feedback=Try again. The output should be negative, variables=

__code:0 def my_fun(x):
    &quot;&quot;&quot;Test function&quot;&quot;&quot;
    return x**3 + 1
output=-3, feedback=Success., variables=

__code:0 def my_fun(x):
    &quot;&quot;&quot;Test function&quot;&quot;&quot;
    return x**3 - 2
</pre></div>
</div>
</div>
</div>
</section>
<section id="example-of-hyper-parameter-optimization-for-ml-models">
<h2>Example of hyper-parameter optimization for ML models<a class="headerlink" href="#example-of-hyper-parameter-optimization-for-ml-models" title="Link to this heading">#</a></h2>
<p>We can use <code class="docutils literal notranslate"><span class="pre">trace</span></code> to optimize the hyper-parameters of a machine learning model using language feedbacks. This example requires <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>. Before running the cell below, please ensure that it is installed using:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pip install scikit-learn
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">pip</span> install scikit-learn
<span class="o">%</span><span class="k">pip</span> install pandas
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_openml</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.utils</span> <span class="kn">import</span> <span class="n">check_random_state</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="n">train_samples</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">fetch_openml</span><span class="p">(</span><span class="s2">&quot;mnist_784&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">as_frame</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">permutation</span> <span class="o">=</span> <span class="n">random_state</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">permutation</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">permutation</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_validation</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_validation</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="n">train_samples</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">20000</span><span class="p">)</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_validation</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_validation</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The language feedback consists of a text representation of the validation accuracy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">scorer</span><span class="p">(</span><span class="n">classifier</span><span class="p">,</span> <span class="n">guess</span><span class="p">,</span> <span class="n">history</span><span class="p">):</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_validation</span><span class="p">,</span> <span class="n">y_validation</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">sparsity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">classifier</span><span class="o">.</span><span class="n">coef_</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">return_feedback</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Score is the accuracy of the classifier on the validation set, and should be maximized.&quot;</span>
    <span class="n">return_feedback</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sparsity is the percentage of zero coefficients in the classifier. If the classifier is overfit, a higher sparsity will yield a better score. If the classifier is underfit however, a lower sparsity will yield a better score.&quot;</span>
    <span class="n">return_feedback</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;By lowering the regularization parameter (must always be positive), the sparsity will increase. By increasing the regularization parameter, the sparsity will decrease.&quot;</span>
    <span class="n">return_feedback</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Most recent guess: </span><span class="se">\n</span><span class="s2">Regularization Parameter: </span><span class="si">{</span><span class="n">guess</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, Score: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%, Sparsity: </span><span class="si">{</span><span class="n">sparsity</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">history</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">return_feedback</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">History of guesses:&quot;</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">history</span><span class="p">:</span>
            <span class="n">return_feedback</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Regularization Parameter: </span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, Score: </span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%, Sparsity: </span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">return_feedback</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">sparsity</span>


<span class="nd">@bundle</span><span class="p">(</span><span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">train_classifier</span><span class="p">(</span><span class="n">regularization_parameter</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;regularization_parameter is a positive number that controls the sparsity of the classifier. Lower values will increase sparsity, and higher values will decrease sparsity.&quot;&quot;&quot;</span>
    <span class="n">classifier</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">regularization_parameter</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="s2">&quot;l1&quot;</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s2">&quot;saga&quot;</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">classifier</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">node</span><span class="p">(</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">OptoPrime</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="n">config_list</span><span class="o">=</span><span class="n">autogen</span><span class="o">.</span><span class="n">config_list_from_json</span><span class="p">(</span><span class="s2">&quot;OAI_CONFIG_LIST&quot;</span><span class="p">))</span>

<span class="n">history</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">bestScore</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">bestRegularization</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">classifier</span> <span class="o">=</span> <span class="n">train_classifier</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">fb</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">sparsity</span> <span class="o">=</span> <span class="n">scorer</span><span class="p">(</span><span class="n">classifier</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">history</span><span class="p">)</span>
    <span class="n">history</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">sparsity</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;variable=</span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="si">}</span><span class="s2">, feedback=</span><span class="si">{</span><span class="n">fb</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># logging</span>
    <span class="k">if</span> <span class="n">bestScore</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="n">bestScore</span><span class="p">:</span>
        <span class="n">bestScore</span> <span class="o">=</span> <span class="n">score</span>
        <span class="n">bestRegularization</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">data</span>

    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_feedback</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">backward</span><span class="p">(</span><span class="n">classifier</span><span class="p">,</span> <span class="n">fb</span><span class="p">)</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best regularization parameter:&quot;</span><span class="p">,</span> <span class="n">bestRegularization</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best score:&quot;</span><span class="p">,</span> <span class="n">bestScore</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>variable=0.005, feedback=
Score is the accuracy of the classifier on the validation set, and should be maximized.
Sparsity is the percentage of zero coefficients in the classifier. If the classifier is overfit, a higher sparsity will yield a better score. If the classifier is underfit however, a lower sparsity will yield a better score.By lowering the regularization parameter (must always be positive), the sparsity will increase. By increasing the regularization parameter, the sparsity will decrease.

Most recent guess: 
Regularization Parameter: 0.0050, Score: 83.17%, Sparsity: 76.88%
variable=0.01, feedback=
Score is the accuracy of the classifier on the validation set, and should be maximized.
Sparsity is the percentage of zero coefficients in the classifier. If the classifier is overfit, a higher sparsity will yield a better score. If the classifier is underfit however, a lower sparsity will yield a better score.By lowering the regularization parameter (must always be positive), the sparsity will increase. By increasing the regularization parameter, the sparsity will decrease.

Most recent guess: 
Regularization Parameter: 0.0100, Score: 85.51%, Sparsity: 64.73%

History of guesses:
Regularization Parameter: 0.0050, Score: 83.17%, Sparsity: 76.88%
variable=0.05, feedback=
Score is the accuracy of the classifier on the validation set, and should be maximized.
Sparsity is the percentage of zero coefficients in the classifier. If the classifier is overfit, a higher sparsity will yield a better score. If the classifier is underfit however, a lower sparsity will yield a better score.By lowering the regularization parameter (must always be positive), the sparsity will increase. By increasing the regularization parameter, the sparsity will decrease.

Most recent guess: 
Regularization Parameter: 0.0500, Score: 86.84%, Sparsity: 28.30%

History of guesses:
Regularization Parameter: 0.0050, Score: 83.17%, Sparsity: 76.88%
Regularization Parameter: 0.0100, Score: 85.51%, Sparsity: 64.73%
variable=0.07, feedback=
Score is the accuracy of the classifier on the validation set, and should be maximized.
Sparsity is the percentage of zero coefficients in the classifier. If the classifier is overfit, a higher sparsity will yield a better score. If the classifier is underfit however, a lower sparsity will yield a better score.By lowering the regularization parameter (must always be positive), the sparsity will increase. By increasing the regularization parameter, the sparsity will decrease.

Most recent guess: 
Regularization Parameter: 0.0700, Score: 87.00%, Sparsity: 27.95%

History of guesses:
Regularization Parameter: 0.0050, Score: 83.17%, Sparsity: 76.88%
Regularization Parameter: 0.0100, Score: 85.51%, Sparsity: 64.73%
Regularization Parameter: 0.0500, Score: 86.84%, Sparsity: 28.30%
variable=0.1, feedback=
Score is the accuracy of the classifier on the validation set, and should be maximized.
Sparsity is the percentage of zero coefficients in the classifier. If the classifier is overfit, a higher sparsity will yield a better score. If the classifier is underfit however, a lower sparsity will yield a better score.By lowering the regularization parameter (must always be positive), the sparsity will increase. By increasing the regularization parameter, the sparsity will decrease.

Most recent guess: 
Regularization Parameter: 0.1000, Score: 86.95%, Sparsity: 24.81%

History of guesses:
Regularization Parameter: 0.0050, Score: 83.17%, Sparsity: 76.88%
Regularization Parameter: 0.0100, Score: 85.51%, Sparsity: 64.73%
Regularization Parameter: 0.0500, Score: 86.84%, Sparsity: 28.30%
Regularization Parameter: 0.0700, Score: 87.00%, Sparsity: 27.95%
variable=0.075, feedback=
Score is the accuracy of the classifier on the validation set, and should be maximized.
Sparsity is the percentage of zero coefficients in the classifier. If the classifier is overfit, a higher sparsity will yield a better score. If the classifier is underfit however, a lower sparsity will yield a better score.By lowering the regularization parameter (must always be positive), the sparsity will increase. By increasing the regularization parameter, the sparsity will decrease.

Most recent guess: 
Regularization Parameter: 0.0750, Score: 86.92%, Sparsity: 27.07%

History of guesses:
Regularization Parameter: 0.0050, Score: 83.17%, Sparsity: 76.88%
Regularization Parameter: 0.0100, Score: 85.51%, Sparsity: 64.73%
Regularization Parameter: 0.0500, Score: 86.84%, Sparsity: 28.30%
Regularization Parameter: 0.0700, Score: 87.00%, Sparsity: 27.95%
Regularization Parameter: 0.1000, Score: 86.95%, Sparsity: 24.81%
variable=0.07, feedback=
Score is the accuracy of the classifier on the validation set, and should be maximized.
Sparsity is the percentage of zero coefficients in the classifier. If the classifier is overfit, a higher sparsity will yield a better score. If the classifier is underfit however, a lower sparsity will yield a better score.By lowering the regularization parameter (must always be positive), the sparsity will increase. By increasing the regularization parameter, the sparsity will decrease.

Most recent guess: 
Regularization Parameter: 0.0700, Score: 86.86%, Sparsity: 24.62%

History of guesses:
Regularization Parameter: 0.0050, Score: 83.17%, Sparsity: 76.88%
Regularization Parameter: 0.0100, Score: 85.51%, Sparsity: 64.73%
Regularization Parameter: 0.0500, Score: 86.84%, Sparsity: 28.30%
Regularization Parameter: 0.0700, Score: 87.00%, Sparsity: 27.95%
Regularization Parameter: 0.1000, Score: 86.95%, Sparsity: 24.81%
Regularization Parameter: 0.0750, Score: 86.92%, Sparsity: 27.07%
variable=0.065, feedback=
Score is the accuracy of the classifier on the validation set, and should be maximized.
Sparsity is the percentage of zero coefficients in the classifier. If the classifier is overfit, a higher sparsity will yield a better score. If the classifier is underfit however, a lower sparsity will yield a better score.By lowering the regularization parameter (must always be positive), the sparsity will increase. By increasing the regularization parameter, the sparsity will decrease.

Most recent guess: 
Regularization Parameter: 0.0650, Score: 86.97%, Sparsity: 28.20%

History of guesses:
Regularization Parameter: 0.0050, Score: 83.17%, Sparsity: 76.88%
Regularization Parameter: 0.0100, Score: 85.51%, Sparsity: 64.73%
Regularization Parameter: 0.0500, Score: 86.84%, Sparsity: 28.30%
Regularization Parameter: 0.0700, Score: 87.00%, Sparsity: 27.95%
Regularization Parameter: 0.1000, Score: 86.95%, Sparsity: 24.81%
Regularization Parameter: 0.0750, Score: 86.92%, Sparsity: 27.07%
Regularization Parameter: 0.0700, Score: 86.86%, Sparsity: 24.62%
variable=0.07, feedback=
Score is the accuracy of the classifier on the validation set, and should be maximized.
Sparsity is the percentage of zero coefficients in the classifier. If the classifier is overfit, a higher sparsity will yield a better score. If the classifier is underfit however, a lower sparsity will yield a better score.By lowering the regularization parameter (must always be positive), the sparsity will increase. By increasing the regularization parameter, the sparsity will decrease.

Most recent guess: 
Regularization Parameter: 0.0700, Score: 86.94%, Sparsity: 27.12%

History of guesses:
Regularization Parameter: 0.0050, Score: 83.17%, Sparsity: 76.88%
Regularization Parameter: 0.0100, Score: 85.51%, Sparsity: 64.73%
Regularization Parameter: 0.0500, Score: 86.84%, Sparsity: 28.30%
Regularization Parameter: 0.0700, Score: 87.00%, Sparsity: 27.95%
Regularization Parameter: 0.1000, Score: 86.95%, Sparsity: 24.81%
Regularization Parameter: 0.0750, Score: 86.92%, Sparsity: 27.07%
Regularization Parameter: 0.0700, Score: 86.86%, Sparsity: 24.62%
Regularization Parameter: 0.0650, Score: 86.97%, Sparsity: 28.20%
variable=0.072, feedback=
Score is the accuracy of the classifier on the validation set, and should be maximized.
Sparsity is the percentage of zero coefficients in the classifier. If the classifier is overfit, a higher sparsity will yield a better score. If the classifier is underfit however, a lower sparsity will yield a better score.By lowering the regularization parameter (must always be positive), the sparsity will increase. By increasing the regularization parameter, the sparsity will decrease.

Most recent guess: 
Regularization Parameter: 0.0720, Score: 86.88%, Sparsity: 28.07%

History of guesses:
Regularization Parameter: 0.0050, Score: 83.17%, Sparsity: 76.88%
Regularization Parameter: 0.0100, Score: 85.51%, Sparsity: 64.73%
Regularization Parameter: 0.0500, Score: 86.84%, Sparsity: 28.30%
Regularization Parameter: 0.0700, Score: 87.00%, Sparsity: 27.95%
Regularization Parameter: 0.1000, Score: 86.95%, Sparsity: 24.81%
Regularization Parameter: 0.0750, Score: 86.92%, Sparsity: 27.07%
Regularization Parameter: 0.0700, Score: 86.86%, Sparsity: 24.62%
Regularization Parameter: 0.0650, Score: 86.97%, Sparsity: 28.20%
Regularization Parameter: 0.0700, Score: 86.94%, Sparsity: 27.12%
Best regularization parameter: 0.07
Best score: 87.005
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./tutorials"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="basic_tutorial.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Basics</p>
      </div>
    </a>
    <a class="right-next"
       href="error_handling_tutorial.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Error Handling</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#backpropagation">Backpropagation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-of-full-optimization-loop">Example of Full Optimization Loop</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-constraints">Adding constraints</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-of-optimizing-strings">Example of optimizing strings</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-of-optimizing-functions">Example of optimizing functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-of-hyper-parameter-optimization-for-ml-models">Example of hyper-parameter optimization for ML models</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ching-An Cheng, Allen Nie, Adith Swaminathan
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024 Trace Team.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <a href='mailto:chinganc@microsoft.com'>Contact Us</a> | <a href='http://go.microsoft.com/fwlink/?LinkId=521839'>Privacy &amp; Cookies</a> | <a href='https://go.microsoft.com/fwlink/?linkid=2259814'>Consumer Health Privacy</a> | <a href='https://go.microsoft.com/fwlink/?LinkID=206977'>Terms Of Use</a> | <a href='https://www.microsoft.com/trademarks'>Trademarks</a>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>